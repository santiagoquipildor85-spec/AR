<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realidad Aumentada - Detector de Formas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="ar-styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#764ba2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <script src="https://docs.opencv.org/4.7.0/opencv.js"></script>
</head>
<body class="ar-body">
    <div class="ar-container-fullscreen">
        <!-- Bot칩n de cerrar minimalista -->
        <button id="backBtn" class="btn-close">칑</button>
        
        <!-- C치mara fullscreen -->
        <div class="camera-fullscreen">
            <video id="video" autoplay playsinline></video>
            <canvas id="canvas"></canvas>
            <div class="ar-overlay" id="arOverlay"></div>
        </div>

        <!-- Indicador de estado minimalista -->
        <div class="status-indicator" id="statusIndicator">
            <div class="status-dot"></div>
            <span id="statusText">Toca para iniciar</span>
        </div>
    </div>

    <!-- Plantillas de informaci칩n minimalistas -->
    <template id="circleInfo">
        <div class="ar-info-card circle-info">
            <h4>游댯 C칤rculo</h4>
        </div>
    </template>

    <template id="squareInfo">
        <div class="ar-info-card square-info">
            <h4>游릴 Cuadrado</h4>
        </div>
    </template>

    <template id="triangleInfo">
        <div class="ar-info-card triangle-info">
            <h4>游댴 Tri치ngulo</h4>
        </div>
    </template>

    <template id="rectangleInfo">
        <div class="ar-info-card rectangle-info">
            <h4>游릱 Rect치ngulo</h4>
        </div>
    </template>

    <!-- Sistema avanzado de detecci칩n m칰ltiple -->
    <script src="custom-shapes.js"></script>
    <script src="advanced-shape-detector.js"></script>
    <script src="tracking-system.js"></script>
    <script src="shape-detection-algorithms.js"></script>
    <script src="image-template-detector.js"></script>
    <script>
        // Inicializar sistema avanzado
        document.addEventListener('DOMContentLoaded', () => {
            window.advancedDetector = new AdvancedShapeDetector();
            
            // Agregar funciones auxiliares
            window.advancedDetector.updateStatus = function(text, state = 'ready') {
                const statusText = document.getElementById('statusText');
                const statusDot = document.querySelector('.status-dot');
                
                if (statusText) statusText.textContent = text;
                if (statusDot) {
                    statusDot.className = 'status-dot';
                    if (state === 'active') statusDot.classList.add('active');
                    if (state === 'detecting') statusDot.classList.add('detecting');
                }
            };
            
            window.advancedDetector.clearAROverlay = function() {
                const overlay = document.getElementById('arOverlay');
                if (overlay) {
                    while (overlay.firstChild) {
                        overlay.removeChild(overlay.firstChild);
                    }
                }
            };
            
            window.advancedDetector.goBack = function() {
                if (this.isRunning) this.stopDetection();
                window.location.href = 'index.html';
            };
            
            window.advancedDetector.stopDetection = function() {
                this.isRunning = false;
                
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
                
                if (this.stream) {
                    this.stream.getTracks().forEach(track => track.stop());
                    this.stream = null;
                }
                
                if (this.video && this.video.srcObject) {
                    this.video.srcObject = null;
                }
                
                this.clearAROverlay();
                this.trackedShapes.clear();
                this.trackingHistory.clear();
                
                this.updateStatus('Toca para iniciar', 'ready');
                console.log('Detecci칩n avanzada detenida');
            };
        });
    </script>
</body>
</html>
